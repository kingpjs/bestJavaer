# 操作系统文件系统概述

所有的应用程序都需要`存储`和`检索`信息。进程运行时，它能够在自己的存储空间内存储一定量的信息。然而，存储容量受`虚拟地址空间`大小的限制。对于一些应用程序来说，存储空间的大小是充足的，但是对于其他一些应用程序，比如航空订票系统、银行系统、企业记账系统来说，这些容量又显得太小了。

第二个问题是，当进程终止时信息会丢失。对于一些应用程序（例如数据库），信息会长久保留。在这些进程终止时，相关的信息应该保留下来，是不能丢失的。甚至这些应用程序崩溃后，信息也应该保留下来。

第三个问题是，通常需要很多进程在同一时刻访问这些信息。解决这种问题的方式是把这些信息单独保留在各自的进程中。

因此，对于长久存储的信息我们有三个基本需求：

* **必须要有可能存储的大量的信息**
  * **信息必须能够在进程终止时保留**

* **必须能够使多个进程同时访问有关信息**

`磁盘(Magnetic disk)` 一直是用来长久保存信息的设备。近些年来，`固态硬盘`逐渐流行起来。

![](https://img2020.cnblogs.com/blog/1515111/202003/1515111-20200325130718987-1349698792.png)

**固态硬盘不仅没有易损坏的移动部件，而且能够提供快速的随机访问**。相比而言，虽然磁带和光盘也被广泛使用，但是它们的**性能相对较差**，通常应用于备份。我们会在后面探讨磁盘，现在姑且把磁盘当作一种大小固定块的线性序列好了，并且支持如下操作

* 读块 k 
* 写块 k

![](https://img2020.cnblogs.com/blog/1515111/202003/1515111-20200325130722813-1792299311.png)

事实上磁盘支持更多的操作，**但是只要有了读写操作，原则上就能够解决长期存储的问题**。

然而，磁盘还有一些不便于实现的操作，特别是在有很多程序或者多用户使用的大型系统上（如服务器）。在这种情况下，很容易产生一些问题，例如

* 你如何找到这些信息？

* 你如何保证一个用户不会读取另外一个用户的数据？

* 你怎么知道哪些块是空闲的？等等问题

我们可以针对这些问题提出一个新的抽象 - `文件`。**进程和线程的抽象、地址空间和文件都是操作系统的重要概念**。如果你能真正深入了解这三个概念，那么你就走上了成为操作系统专家的道路。

`文件(Files)`是由进程创建的逻辑信息单元。一个磁盘会包含几千甚至几百万个文件，每个文件是独立于其他文件的。事实上，如果你能把每个文件都看作一个独立的地址空间，那么你就可以真正理解文件的概念了。

进程能够读取已经存在的文件，并在需要时重新创建他们。存储在文件中的信息必须是`持久的`，这也就是说，不会因为进程的创建和终止而受影响。一个文件只能在当用户明确删除的时候才能消失。尽管读取和写入都是最基本的操作，但还有许多其他操作，我们将在下面介绍其中的一些。

文件由操作系统进行管理，有关文件的构造、命名、访问、使用、保护、实现和管理方式都是操作系统设计的主要内容。从总体上看，操作系统中处理文件的部分称为 `文件系统(file system)`，这就是我们所讨论的。

从用户角度来说，用户通常会关心文件是由什么组成的，如何给文件进行命名，如何保护文件，以及可以对文件进行哪些操作等等。尽管是用链表还是用位图记录内存空闲区并不是用户所关心的主题，而这些对系统设计人员来说至关重要。